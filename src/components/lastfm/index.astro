---
// import { Lastfm } from "./Lastfm";

import { GET } from "../../pages/api/last-song.json";

let response = await GET(Astro);
const data = await response.json();

// const currentPath = Astro.url.pathname;
// const fullPathName = new URL(currentPath, Astro.url).href;

// const lastSong_alt = await fetch(`https://juanberrios.com/api/last-song.json`);
// const lastSong_alt_res = await lastSong_alt.json().then((data) => data);
const { name, artist, image, playDate } = data;
---

<!-- <Lastfm lastSong={data} client:load /> -->{
  data ? (
    <div class="listening-wrapper">
      <h2>Escuchando</h2>
      <div class="listening">
        <img class="cover" src={image} alt={`${artist} album`} />
        <div class="info">
          <p class="song">{name}</p>
          <p class="artist">{artist}</p>
          <p class="date">
            {playDate ? (
              <>
                Reproducido el {playDate.day} de{" "}
                <span class="month">{playDate.month}</span>
                <span> a las {playDate.time} hrs</span>
              </>
            ) : (
              "Reproduciendo ahora"
            )}
          </p>
        </div>
      </div>
    </div>
  ) : (
    <div class="listening-wrapper">
      <p>Cargandoâ€¦</p>
    </div>
  )
}
